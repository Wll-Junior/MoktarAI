<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MoktarAI Chat</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#121212;color:#fff}
    .chat{display:flex;flex-direction:column;height:100vh}
    .messages{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:10px}
    .bubble{max-width:70%;padding:12px;border-radius:12px}
    .user{align-self:flex-end;background:#2D8CFF;color:#fff}
    .ai{align-self:flex-start;background:#333;color:#fff}
    .footer{display:flex;padding:12px;border-top:1px solid #444}
    input{flex:1;padding:10px;border:none;border-radius:8px;background:#222;color:#fff}
    button{margin-left:8px;padding:10px;border:none;border-radius:8px;background:#2D8CFF;color:#fff;cursor:pointer}
  </style>
</head>
<body>
  <div class="chat">
    <div class="messages" id="messages"></div>
    <div class="footer">
      <input type="text" id="userInput" placeholder="Type your message...">
      <button id="sendBtn">Send</button>
    </div>
  </div>

  <script>
    const msgs = document.getElementById("messages");
    const input = document.getElementById("userInput");
    const sendBtn = document.getElementById("sendBtn");

    function addBubble(text, from){
      const b = document.createElement("div");
      b.className = "bubble " + (from==="user" ? "user" : "ai");
      b.textContent = text;
      msgs.appendChild(b);
      msgs.scrollTop = msgs.scrollHeight;
    }

    async function sendMessage(text){
      addBubble(text, "user");
      try {
        const res = await fetch("http://localhost:3000/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });
        const data = await res.json();
        addBubble(data.reply, "ai");
      } catch (err) {
        addBubble("❌ Error contacting AI engine.", "ai");
      }
    }

    sendBtn.onclick = ()=>{
      const text = input.value.trim();
      if (!text) return;
      input.value = "";
      sendMessage(text);
    };
  </script>
</body>
</html>
