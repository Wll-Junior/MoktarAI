<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>MoktarAI — Chat refined replies</title>
  <link rel="icon" href="assets/logo.png">
  <style>
    :root{
      --bg:#121212; --panel:#1E1E1E; --text:#E0E0E0; --muted:#9AA0A6;
      --line:#333; --blue:#2D8CFF; --yellow:#FFD43B; --green:#28a745;
    }
    body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,Roboto,Arial,sans-serif}
    .app{display:flex;height:100vh}

    /* Sidebar (text-style items) */
    .sidebar{width:260px;background:var(--panel);border-right:1px solid var(--line);display:flex;flex-direction:column;padding:16px;gap:14px}
    .sidebar-header{display:flex;align-items:center;gap:12px}
    .logo{width:44px;height:44px;border-radius:50%;border:2px solid var(--blue)}
    .app-name{font-weight:700}
    .menu button{background:transparent;border:none;color:inherit;padding:6px 0;text-align:left;cursor:pointer}
    .menu button:hover{color:var(--blue)}
    .divider{border:0;border-top:1px solid var(--line);margin:8px 0}
    .account{display:flex;align-items:center;gap:10px}
    .avatar{width:40px;height:40px;border-radius:50%}
    .handle{font-size:12px;color:var(--muted)}

    /* Chat area */
    .main{flex:1;display:flex;flex-direction:column}
    .topbar{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--line)}
    .welcome{text-align:center;padding:28px 16px}
    .welcome h1{margin:0 0 12px;font-size:20px}
    .search-bar{display:flex;justify-content:center;gap:8px}
    .search-input{width:420px;padding:10px;border-radius:10px;border:1px solid var(--line);background:#181818;color:#fff}
    .search-btn{background:var(--blue);color:#fff;border:none;border-radius:10px;padding:10px;cursor:pointer}

    .messages{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:10px}
    .bubble{max-width:72%;padding:12px 14px;border-radius:12px;line-height:1.55}
    .from-user{align-self:flex-end;background:var(--blue);color:#fff}
    .from-ai{align-self:flex-start;background:#2E2E2E;color:#fff}

    /* Footer */
    .footer{display:grid;grid-template-columns:auto 1fr auto auto;gap:8px;align-items:center;padding:12px;border-top:1px solid var(--line)}
    .btn{padding:8px 12px;border:none;border-radius:10px;cursor:pointer}
    .btn-plus{background:var(--yellow);color:#000}
    .btn-voice{background:var(--green);color:#fff}
    .btn-send{background:var(--blue);color:#fff}

    /* Edge scroll */
    .edge-scroll{position:fixed;right:16px;bottom:92px;display:flex;flex-direction:column;gap:8px}
    .edge-scroll button{background:#2a2a2a;color:#fff;border:none;border-radius:8px;padding:8px;cursor:pointer}
  </style>
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <img src="assets/logo.png" class="logo" alt="Logo">
        <div class="app-name">MoktarAI</div>
      </div>
      <div class="menu">
        <button>New chat</button>
        <button>Library</button>
        <button>Projects</button>
        <button>Your conversations</button>
      </div>
      <hr class="divider">
      <div class="account">
        <img src="assets/avatar.png" class="avatar" alt="Avatar">
        <div>
          <div>Abdirizak Hero</div>
          <div class="handle">@naaifow17</div>
        </div>
      </div>
    </aside>

    <!-- Chat area -->
    <main class="main">
      <div class="topbar">
        <strong>MoktarAI</strong>
        <div>
          <button>🔗 Share</button>
          <button>⋮</button>
        </div>
      </div>
      <div class="welcome" id="welcome">
        <h1>Welcome notes rotate. Ask or pick one anytime.</h1>
        <div class="search-bar">
          <input type="text" class="search-input" id="searchInput" placeholder="Ask anything...">
          <button class="search-btn" id="searchVoice">🎤</button>
          <button class="search-btn" id="searchSend">Send</button>
        </div>
      </div>
      <div class="messages" id="messages"></div>
      <div class="footer">
        <button class="btn btn-plus" id="btn-plus">+</button>
        <input type="text" id="userInput" class="search-input" placeholder="Type your message here...">
        <button class="btn btn-voice" id="btn-voice">🎤 Voice</button>
        <button class="btn btn-send" id="btn-send">Send</button>
      </div>
    </main>
  </div>

  <!-- Edge scrolling buttons -->
  <div class="edge-scroll">
    <button id="scrollUp">↑ Up</button>
    <button id="scrollDown">↓ Down</button>
  </div>

  <script>
    const msgs = document.getElementById("messages");
    const input = document.getElementById("userInput");
    const welcome = document.getElementById("welcome");
    const searchInput = document.getElementById("searchInput");

    // Rotate welcome lines per your spec
    const welcomes = [
      "Qoraalo soo dhaweyn iyo codsi ah ha bed bedela markaste asina ha doorto.",
      "Welcome! Ask anything or pick a suggestion.",
      "Ku bilow hal su’aal ama dooro mid ka muuqda."
    ];
    let wIdx = 0;
    setInterval(()=>{
      const h = welcome?.querySelector("h1");
      if (h) { wIdx = (wIdx+1)%welcomes.length; h.textContent = welcomes[wIdx]; }
    }, 5000);

    // Language auto-detect (Somali vs English baseline)
    function detectLang(t){
      const so = /(maanta|waa|immisa|magacaa|soo jeedin|barto|sawir|iska|waran|asc|waan)/i.test(t);
      const en = /(how\s*are\s*you|what'?s|name|learn|picture|image|math|hello|hi)/i.test(t);
      if (so && !en) return "so";
      if (en && !so) return "en";
      // Mixed or unknown: mirror user language heuristically
      return /[a-z]/i.test(t) ? (/[āā]/.test(t) ? "so" : (/[A-Za-z]/.test(t) ? "en" : "so")) : "en";
    }

    // Intent rules
    const rules = [
      { id:"greet",   so:/sidee\s*tahay|iska\s*waran|salaan|asc/i, en:/how\s*are\s*you|hello|hi|hey/i },
      { id:"math22",  so:/2\s*\+\s*2/i, en:/2\s*\+\s*2/i },
      { id:"learn",   so:/maxaad\s*.*barto|barto|xirfado|taariikh|luqad/i, en:/what\s*should.*learn|learn|study/i },
      { id:"name",    so:/magacaa/i, en:/name\??|what'?s\s*your\s*name/i },
      { id:"nameEn",  so:/english.*magacaa/i, en:/name.*in\s*english/i },
      { id:"image",   so:/ii\s*sameey\s*sawir|sawir\s*samay/i, en:/make\s*image|create\s*picture|draw/i },
      { id:"other",   so:/./i, en:/./i }
    ];

    // Memory to reduce repetition
    const memory = { lastIntent:null, lastLang:null };

    function reply(text){
      const t = (text||"").trim();
      const lang = detectLang(t);
      let intent = "other";
      for (const r of rules){
        const test = lang==="so" ? r.so : r.en;
        if (test && test.test(t)) { intent = r.id; break; }
      }

      // Anti-repeat: if same intent twice, vary the opener slightly
      const vary = (a,b)=> (memory.lastIntent===intent ? b : a);
      memory.lastIntent = intent;
      memory.lastLang = lang;

      // Responses per your spec
      if (intent==="greet"){
        return lang==="so"
          ? vary("Waan fiicanahay, saaxiib! Maanta diyaar ayaan u ahay inaan kaa caawiyo wixii aad u baahan tahay. 😄",
                 "Haa, waan joogaa. Sidee tahay adiga maanta?")
          : vary("I’m good, friend! Ready to help you today. 😄",
                 "I’m here and ready. How are you feeling today?");
      }

      if (intent==="math22"){
        return lang==="so"
          ? "Hadda aan si sax ah u xisaabno: 2 + 2 = 4 ✅"
          : "Let’s compute it step by step: 2 + 2 = 4 ✅";
      }

      if (intent==="learn"){
        return lang==="so"
          ? "Waxaad baran kartaa luqad cusub, xisaab, taariikh, ama xirfado kombuyuutar. Maxaad doorbideysaa inaad bilowdo?"
          : "You could learn a new language, math, history, or computer skills. Which do you prefer to start with?";
      }

      if (intent==="name"){
        return lang==="so" ? "Magaceyga waa MoktarAI." : "My name is MoktarAI.";
      }

      if (intent==="nameEn"){
        return lang==="so"
          ? "Magacaa waxaa English lagu dhahaa “What’s your name”."
          : "In English, it's “What’s your name”.";
      }

      if (intent==="image"){
        return lang==="so"
          ? "Sawir toos ah ma sameyn karo. Balse waan ku caawin karaa qoraal faahfaahin, SVG/icon talooyin, ama layout sharaxaad."
          : "I can’t generate images. I can help with detailed prompts, SVG/icon suggestions, or layout descriptions.";
      }

      // Default, mirror language and be helpful without vague filler
      return lang==="so"
        ? "Waan helay fariintaada. Sheeg natiijada aad rabto si aan si toos ah ugu socdo."
        : "I received your message. Tell me the exact outcome you want and I’ll proceed directly.";
    }

    function addMessage(text, from){
      if (welcome) welcome.style.display = "none";
      const b = document.createElement("div");
      b.className = "bubble " + (from === "user" ? "from-user" : "from-ai");
      b.textContent = text;
      msgs.appendChild(b);
      msgs.scrollTop = msgs.scrollHeight;
    }

    function sendNow(text){
      if (!text) return;
      addMessage(text, "user");
      setTimeout(()=>addMessage(reply(text), "ai"), 250);
    }

    // Footer and welcome inputs
    document.getElementById("btn-send").onclick = ()=>{
      const text = input.value.trim();
      if (!text) return;
      input.value = "";
      sendNow(text);
    };
    document.getElementById("btn-voice").onclick = ()=>addMessage("🎤 Voice input (demo).","ai");
    document.getElementById("btn-plus").onclick  = ()=>addMessage("➕ Actions: Create ✨ / Search 🔍","ai");
    document.getElementById("searchSend").onclick = ()=>{
      const v = searchInput.value.trim();
      if (!v) return;
      searchInput.value = "";
      sendNow(v);
    };

    // Edge scrolling
    const messagesEl = document.getElementById("messages");
    document.getElementById("scrollUp").onclick = ()=>messagesEl.scrollBy({ top: -300, behavior: "smooth" });
    document.getElementById("scrollDown").onclick = ()=>messagesEl.scrollBy({ top: 300, behavior: "smooth" });
  </script>
</body>
</html>
